# Инструкция по запуску и использованию GT7 Telemetry Flutter

## Требования
- Установленный Flutter SDK
- Gran Turismo 7 на PlayStation 4/5
- Оба устройства (PlayStation и компьютер/устройство с приложением) должны быть в одной сети Wi-Fi

## Настройка GT7
1. Включите Gran Turismo 7 на своей PlayStation
2. Перейдите в Настройки игры
3. Найдите раздел "Telemetry" или "Data Transfer"
4. Включите отправку телеметрии по UDP
5. Запомните IP-адрес вашей PlayStation (например, 192.168.0.177)

## Запуск приложения
1. Откройте проект в терминале:
   ```bash
   cd /Users/nikitafedorov008/IdeaProjects/gt7telemetry/gt7_telemetry_flutter
   ```

2. Запустите приложение:
   ```bash
   flutter run -d macos
   # или для других платформ:
   flutter run -d iphone  # для iOS
   flutter run -d android  # для Android
   ```

3. Введите IP-адрес вашей PlayStation в поле ввода в приложении
4. Нажмите кнопку "Connect"

## Как работает приложение
- Приложение открывает UDP-порт 33740 для получения данных телеметрии
- Отправляет heartbeat-пакеты (байт 'A' = 65) на порт 33739 для поддержания соединения
- Полученные данные расшифровываются с помощью Salsa20
- После расшифровки данные парсятся и отображаются в UI

## Проверка соединения
- Если соединение успешно, вы увидите зеленый индикатор "Connected" вверху
- Если нет, проверьте:
  - Правильно ли введен IP-адрес PlayStation
  - Включена ли телеметрия в GT7
  - Находятся ли оба устройства в одной сети
  - Не блокирует ли брандмауэр UDP-трафик на портах 33739 и 33740

## Отладка
Если приложение не получает данные:
1. Проверьте логи Flutter с помощью `flutter run` - там будут отображаться полученные UDP-пакеты
2. Убедитесь, что в GT7 включена функция телеметрии
3. Попробуйте использовать Python-версию (gt7telemetry.py) для сравнения

## Порты
- Receive Port: 33740 (для получения телеметрии от GT7)
- Send Port: 33739 (для отправки heartbeat-пакетов)

## Особенности реализации
- Heartbeat отправляется каждые 100 полученных пакетов (как в Python-версии)
- Криптография Salsa20 используется для расшифровки телеметрии
- Проверка magic числа (0x47375330) для валидации пакетов
- Автоматический перезапуск соединения при ошибках

## Платформы
Приложение работает на следующих платформах:
- macOS (протестировано)
- iOS
- Android
- Windows
- Linux